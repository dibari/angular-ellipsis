angular.module("dibari.angular-ellipsis",[]).directive("ellipsis",["$timeout","$window",function(){return{restrict:"A",scope:{ngBind:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@"},compile:function(){return function(a,b,c){function d(){if("undefined"!=typeof a.ngBind){var d=a.ngBind.split(" "),f=0,g="undefined"!=typeof c.ellipsisSymbol?c.ellipsisSymbol:"&hellip;",h="undefined"!=typeof a.ellipsisAppend&&""!==a.ellipsisAppend?g+"<span>"+a.ellipsisAppend+"</span>":g;if(c.isTruncated=!1,b.html(a.ngBind),e(b)){var i=d.length,j=b[0].clientHeight;for(b.html(a.ngBind+h);i>f;f++)if(d.pop(),b.html(d.join(" ")+h),b[0].scrollHeight<j||e(b)===!1){c.isTruncated=!0;break}g!=h&&"undefined"!=typeof a.ellipsisAppendClick&&""!==a.ellipsisAppendClick&&b.find("span").bind("click",function(){a.$apply(a.ellipsisAppendClick)})}}}function e(a){return a[0].scrollHeight>a[0].clientHeight}c.lastWindowResizeTime=0,c.lastWindowResizeWidth=0,c.lastWindowResizeHeight=0,c.lastWindowTimeoutEvent=null,c.isTruncated=!1,a.$watch("ngBind",function(){d()}),a.$watch("ellipsisAppend",function(){d()}),b.bind("resize",function(){d()})}}}}]);